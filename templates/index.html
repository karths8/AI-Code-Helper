<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.0.3/styles/default.min.css">
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.0.3/highlight.min.js"></script>
      <script type="module" src="https://md-block.verou.me/md-block.js"></script>
      <script>hljs.initHighlightingOnLoad();</script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script>
        function checkContentStatus() {
            fetch('/get-content')
                .then(response => response.json())
                .then(data => {
                    if (data.status === 'ready') {
                        // Convert Markdown to HTML
                        // const renderedContent = marked(data.content);
                        document.getElementById('model-response').innerHTML = data.content;
                        document.getElementById('loading').style.display = 'none';
                        document.getElementById('model-response').style.display = 'block';
                    } else {
                        // Check again after some delay
                        setTimeout(checkContentStatus, 1000);
                    }
                })
                .catch(error => console.error('Error fetching content:', error));
        }

        window.onload = function() {
            checkContentStatus();
        };
    </script>
    <meta charset="UTF-8">
    <title>Robot Page</title>
    <style>
    #circular-image {
        float: left;
        margin-top: 175px;
        margin-right: 20px;
        border-radius: 50%;
        width: 200px; /* or any other size */
        height: 200px; /* should be the same as width for a perfect circle */
    }
    </style>
    <style>
    #fixed-size-textbox {
        display: inline-block; 
        vertical-align: top;
        border: 2px solid black;
        border-radius: 10px;
        padding: 20px;
        width: 1000px;  /* Set your desired width */
        height: 500px; /* Set your desired height */
        resize: none;  /* Optional: Prevents resizing */
        overflow: auto;
    }
    </style>
    <style>
    #button-box {
        margin-left: 400px;
        padding: 20px;
    }
    </style>
    <style>
    .button-element {
        width: 70px;
        height: 45px;
        margin: 20px;
        padding: 10px;
        border: 0.5px solid black;
        border-radius: 5px;
    }
    </style>
    <style>
        .centered-container {
            display: flex;
            vertical-align: top;
            text-align: center;
            border: 2px solid black;
            border-radius: 10px;
            padding: 20px;
            font-size: 30px;
            width: 1000px;  /* Set your desired width */
            height: 500px; /* Set your desired height */
            resize: none;  /* Optional: Prevents resizing */
            justify-content: center; /* Center horizontally */
            align-items: center;     /* Center vertically */
        }
    </style>
    <style>
        #loading {
            text-align: center;
            padding: 20px;
            font-size: 30px;
            justify-content: center; /* Center horizontally */
            align-items: center;     /* Center vertically */
        }
    </style>
</head>


    
<body>
    <div>
        <img src="{{ url_for('static', filename='helpful_robot.png') }}" id="circular-image">
        {% if question_num is none %} 
            {% set div_class = 'home' %}
        {% else %}
            {% set div_class = '' %}
        {% endif %}
        <div id="{{'fixed-size-textbox' if div_class != 'home' }}" class="{{'centered-container' if div_class == 'home' }}">
            {% if question_num is not none %} 
            <p>Question Number: Q{{ question_num }}</p>
            
            {% else %}
            <p>Hey I am Your friendly AI code Assistant! I can Help you solve programming problems with a click of a button!</p>
            {% endif %}
            {% if question_str is not none %} 
            <p id="markdown-content">Question:{{ question_str|safe }}</p>
            <p id="html-content"></p>
            {% endif %}
            {% if student_code is not none %} 
            <p>Code Given by the Student:</p>
            <pre><code class="python">{{ student_code|safe }}</code></pre>
            {% endif %}
            {% if student_code is not none %} 
            
            <p>Suggestion given by the model:</p>
            <div id="loading">Loading...</div>
            <div id="model-response"></div>
            {% endif %}
            
        
        
        </div>
    </div>
    <div style="clear: both;" id="button-box">
        <button onclick="window.location.href='code_helper.html';" class="button-element">Home</button>
        {% for i in range(1, num_of_questions+1) %}
            <button onclick="window.location.href='code_helper.html?question=Q{{ i }}';" class="button-element">Q{{ i }}</button>
        {% endfor %}
        
    </div>

    <script>
        // Get the Markdown content from the div
        const markdownText = document.getElementById('markdown-content').innerText;

        // Convert the Markdown text to HTML
        const htmlContent = marked.parse(markdownText);

        // Display the HTML content in another div
        document.getElementById('html-content').innerHTML = htmlContent;

        // Optionally, hide the original Markdown content
        document.getElementById('markdown-content').style.display = 'none';
    </script>

</body>
</html>
